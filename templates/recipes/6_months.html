{% extends "base.html" %}
{% load static %}

{% block title %}6+ Months Recipes{% endblock %}

{% block content %}
<div class="container mt-5 mb-5">
  <div class="card p-4 baby-bg shadow fadeInCard">
    
    <!-- Page Heading -->
    <div id="recipes6">
      <h1 class="text-center" style="font-family: 'Caveat', cursive; color: #ff7597;">
        6+ Months Recipes
      </h1>
      <hr class="pastel-divider">
    </div>

    <!-- ⭐ SORTING DROPDOWN -->
    <form method="get" class="d-flex justify-content-end mb-3" style="gap: 0.5rem;">
      <label for="order-select" class="form-label align-self-center mb-0 me-2" style="font-weight: 600;">Sort by:</label>

      <select id="order-select" name="order" class="form-select w-auto" onchange="this.form.submit()">
        <option value="latest" {% if order == 'latest' %}selected{% endif %}>Latest</option>
        <option value="earliest" {% if order == 'earliest' %}selected{% endif %}>Earliest</option>
      </select>
    </form>
    <!-- ⭐ END SORTING -->

    <!-- Recipe Grid -->
    <div class="post-grid mt-4">
      {% for recipe in recipes %}
      <div class="post-card mb-4">
        {% if recipe.featured_image %}
          <img src="{{ recipe.featured_image.url }}" alt="{{ recipe.title }}" class="card-img-top" style="height: 200px; object-fit: cover;">
        {% endif %}
        <div class="card-body">
          <h3>
              <a href="{% url 'post_detail' slug=recipe.slug %}#post-content" class="green-link">{{ recipe.title }}</a>
          </h3>
          <p class="text-muted">{{ recipe.created_on|date:"F d, Y" }}</p>
          {% if recipe.excerpt %}
            <p>{{ recipe.excerpt|truncatewords:20 }}</p>
          {% endif %}
        </div>
      </div>
      {% empty %}
        <p class="text-center">No recipes found for 6+ months.</p>
      {% endfor %}
    </div>

    <div class="text-center mt-4">
      <a href="{% url 'home' %}" class="btn btn-outline-primary">
        ← Back to Home
      </a>
    </div>
  </div>
</div>

<!-- ⭐ Smooth scroll to center the section when arriving from dropdown -->
<script>
/* jshint esversion: 6 */
/* jshint esversion: 8 */

window.onload = function() {
    const section = document.getElementById('recipes6');
    if(section) {
        // Smaller multiplier moves section slightly lower in viewport for perfect centralization
        const topOffset = (window.innerHeight / 2 - section.offsetHeight / 2) * 0.5;
        const sectionTop = section.getBoundingClientRect().top + window.scrollY;
        window.scrollTo({
            top: sectionTop - topOffset,
            behavior: 'smooth'
        });
    }
};
</script>

{% endblock %}
